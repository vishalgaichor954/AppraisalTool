@model List<AppraisalTool.App.Models.MetricsDto>
@{
    ViewData["Title"] = "AddSelfAppraisal";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

@{
    var EffortList = Model.Where(item => item.List_Id == 1).ToList().Count ;
    var BevList = Model.Where(item => item.List_Id == 3).ToList().Count;
    var JobList = Model.Where(item => item.List_Id == 4).ToList().Count;
}

<div class="container d-flex justify-content-center">
    <div class="col-11">
        <div class="card">
            <div class="card-body">
                <div>
                    <form asp-action="AddSelfAppraisal" enctype="multipart/form-data">
                        <div class="text-danger"></div>
                        <fieldset class="border p-2 m-5" style="display:flex;justify-content:center;">
                            <legend class="float-none w-auto">
                                Input & Effort metric
                            </legend>
                            <div class="row d-flex justify-content-center">
                                @for (int i = 0; i < EffortList; i++)
                                {

                                    <div class="row pt-2">
                                        <div class="row">
                                            <div class="col-9"><h4>@Model[i].Metric_Description</h4></div>
                                            <div class="col-3">
                                                <div class="row d-flex justify-content-center align-items-center">
                                                    <div class="col-5">
                                                        <label>Score</label>
                                                    </div>
                                                    <div class="col-7">
                                                        <input class=" form-control my-2 kra-score" asp-for="@Model[i].Score" type="number">
                                                    </div>
                                                </div>
                                            </div>
                                          
                                        </div>
                                        <div class="row">
                                            <div class="col-12"> <textarea class="form-control " asp-for="@Model[i].Comment" placeholder="Add Comment"></textarea></div>
                                            
                                        </div>
                                        <span asp-validation-for="@Model[i].Comment" class="text-danger mx-1 small"></span>
                                        <span asp-validation-for="@Model[i].Score" class="text-danger mx-1 small"></span>
                                    </div>
                                }
                            </div>
                        </fieldset>
                        <fieldset class="border p-2 m-5" style="display:flex;justify-content:center;">
                            <legend class="float-none w-auto">
                                Behavioral competencies
                            </legend>
                            <div class="row d-flex justify-content-center">
                                @for (int i = EffortList -1; i < EffortList+BevList-1; i++)
                                {
                                    var temp = i + 1;
                                    <div class="row pt-2">
                                        <div class="row">
                                            <div class="col-9"><h4>@Model[temp].Metric_Description</h4></div>
                                            <div class="col-3">
                                                <div class="row d-flex justify-content-center align-items-center">
                                                    <div class="col-5">
                                                        <label>Score</label>
                                                    </div>
                                                    <div class="col-7">
                                                        <input class=" form-control my-2 kra-score" asp-for="@Model[temp].Score" type="number">
                                                    </div>
                                                </div>
                                            </div>

                                        </div>
                                        <div class="row">
                                            <div class="col-12"> <textarea class="form-control " asp-for="@Model[temp].Comment" placeholder="Add Comment"></textarea></div>

                                        </div>
                                        <span asp-validation-for="@Model[temp].Comment" class="text-danger mx-1 small"></span>
                                        <span asp-validation-for="@Model[temp].Score" class="text-danger mx-1 small"></span>
                                    </div>
                                }
                            </div>
                        </fieldset>
                        <fieldset class="border  p-2 m-5" style="display:flex;justify-content:center;">
                            <legend class="float-none w-auto">
                                Job family grooming
                            </legend>
                            <div class="row d-flex justify-content-center">
                                @for (int i = EffortList + BevList - 1; i < EffortList + BevList + JobList - 1; i++)
                                {
                                    var temp = i + 1;
                                    <div class="row pt-2">
                                        <div class="row">
                                            <div class="col-9"><h4>@Model[temp].Metric_Description</h4></div>
                                            <div class="col-3">
                                                <div class="row d-flex justify-content-center align-items-center">
                                                    <div class="col-5">
                                                        <label>Score</label>
                                                    </div>
                                                    <div class="col-7">
                                                        <input class=" form-control my-2 kra-score" asp-for="@Model[temp].Score" type="number">
                                                    </div>
                                                </div>
                                            </div>

                                        </div>
                                        <div class="row">
                                            <div class="col-12"> <textarea class="form-control " asp-for="@Model[temp].Comment" placeholder="Add Comment"></textarea></div>

                                        </div>
                                        <span asp-validation-for="@Model[temp].Comment" class="text-danger mx-1 small"></span>
                                        <span asp-validation-for="@Model[temp].Score" class="text-danger mx-1 small"></span>
                                    </div>
                                }
                            </div>
                        </fieldset>
                        <input id="submit" type="submit" value="submit" class="btn btn-primary mt-4" />
                    </form>
                    <div class="form-group text-center">
                        @*<input type="hidden" name="job" id="job" />
                        <input id="submit" type="submit" value="submit" class="btn btn-primary mt-4" />
                        <input type="reset" value="reset" class="btn btn-danger mt-4" />*@
                        <button type="button" id="btnSubmit" onclick="submit()" class="btn btn-primary mt-4">Submit Temp</button>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script>

    const json = []
    const submit = () => {
        event.preventDefault();
        const scoresClassList = document.querySelectorAll(".kra-score");
        scoresClassList.forEach(item => {
            let comment = document.getElementById(item.getAttribute("name"));
            let obj = {
                MetricId: item.dataset.id,
                KraListId: item.dataset.kraid,
                MetricDescription: item.getAttribute("name"),
                MetricWeihtage: item.dataset.weightage,
                Score: item.value,
                Comment: comment.value
            }
            json.push(obj);
        })
        console.log(json);
    }
</script>


@section Scripts {
    @{
        await Html.RenderPartialAsync("_ValidationScriptsPartial");
    }
    }
    <script src="./lib/assets/vendors/js/vendor.bundle.base.js"></script>

    <!-- endinject -->
    <!-- Plugin js for this page -->
    <!-- End plugin js for this page -->
    <!-- inject:js -->
    <script src="./lib/assets/js/off-canvas.js"></script>


    <script src="./lib/assets/js/hoverable-collapse.js"></script>

    <script src="./lib/assets/js/misc.js"></script>
    <!-- endinject -->

    <script src="~/lib/assets/vendors/js/vendor.bundle.base.js"></script>

    @*<script src="assets/vendors/chart.js/Chart.min.js"></script>*@
    <script src=" ~/lib/assets/vendors/chart.js/Chart.min.js"></script>
    @*    <script src="assets/js/jquery.cookie.js" type="text/javascript"></script>*@
    <script src=" ~/lib/assets/js/jquery.cookie.js" type="text/javascript"></script>
    @*<script src="assets/js/off-canvas.js"></script>
    <script src="assets/js/hoverable-collapse.js"></script>
    <script src="assets/js/misc.js"></script>*@
    <script src=" ~/lib/assets/js/off-canvas.js"></script>
    <script src=" ~/lib/assets/js/hoverable-collapse.js"></script>
    <script src=" ~/lib/assets/js/misc.js"></script>

